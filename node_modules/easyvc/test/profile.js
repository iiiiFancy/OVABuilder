const easyvc = require('../lib/index.js')()

process.env.NODE_TLS_REJECT_UNAUTHORIZED = 0

const host = '35.177.13.243'
const user = 'cloudadmin@vmc.local'
const password = 'yx@6(e7yrA'

async function create() {
	await easyvc.login(host, user, password)
	
	let item = {
		"info": {			
			"name": "test",
			"description": "",
			"type": "Windows"
		},
		"spec": {
			"options": {
				"changeSID": true
			},
			"identity": {
				"userData": {		
					"fullName": "test",
					"orgName": "test",
					"productId": ""
				},
				"guiUnattended": {
					"password": {
						"plainText": false,
						"value": "test"
					},
					"autoLogon": true,
					"autoLogonCount": 1,
					"timeZone": 0
				},
				"guiRunOnce": {					
					"commandList": [
					  "c:\\windows\\system32\\setcert.cmd"
					]
				},
				"licenseFilePrintData": {			
					"autoMode": "perServer",
					"autoUsers": 5
				},
				"identification": {
					"joinWorkgroup": "WORKGROUP"
				}
			},
			"nicSettingMap": [
				{
				  "macAddress": null,
				  "adapter": {			
					"ip": {				
					  "ipAddress": "10.101.0.225"
					},
					"subnetMask": "255.255.0.0",
					"gateway": [
					  "10.101.0.1"
					],
					"ipV6Spec": null,
					"dnsServerList": [
					  "10.101.0.2",
					  "10.0.0.2"
					],
					"dnsDomain": null,
					"primaryWINS": "",
					"secondaryWINS": "",
					"netBIOS": null
				  }
				}
			]
		}		  
	}

	return await easyvc.createCustomizationSpec4Win(item)
}

create().then(console.log).catch(console.error)


